-- Tabela de Usuários
CREATE TABLE usuarios (
    id CHAR(36) PRIMARY KEY,             -- Identificador único para cada usuário (UUID)
    nome VARCHAR(255) NOT NULL,          -- Nome completo do usuário
    email VARCHAR(255) NOT NULL,         -- E-mail do usuário (usado para login)
    senha VARCHAR(255) NOT NULL,         -- Senha do usuário (armazenada de forma segura, com hash)
    role ENUM('admin', 'gerente', 'operador') NOT NULL, -- Papel do usuário no sistema (admin, gerente, operador)
    empresa_id CHAR(36) NOT NULL,        -- ID da empresa associada ao usuário (chave estrangeira da tabela empresas)
    aprovado BOOLEAN DEFAULT 0           -- Indicador se o usuário foi aprovado (0 = não aprovado, 1 = aprovado)
);

CREATE TABLE permissao (
    id CHAR(36) PRIMARY KEY,         -- Identificador único
    nome VARCHAR(255) NOT NULL,      -- Nome da permissão (exemplo: 'ler_dados', 'escrever_dados')
    descricao TEXT                   -- Descrição da permissão
);

CREATE TABLE role (
    id CHAR(36) PRIMARY KEY,        -- Identificador único
    nome VARCHAR(255) NOT NULL,     -- Nome da função (exemplo: 'admin', 'gerente', 'operador')
    descricao TEXT                  -- Descrição sobre o que a função pode fazer
);

CREATE TABLE role_permissao (
    id CHAR(36) PRIMARY KEY,        -- Identificador único
    role_id CHAR(36) NOT NULL,      -- ID da função
    permissao_id CHAR(36) NOT NULL, -- ID da permissão
    FOREIGN KEY (role_id) REFERENCES role(id),            -- Relacionamento com a tabela de funções
    FOREIGN KEY (permissao_id) REFERENCES permissao(id)   -- Relacionamento com a tabela de permissões
);

CREATE TABLE empresa (
    id CHAR(36) PRIMARY KEY,           -- Identificador único
    nome VARCHAR(255) NOT NULL,        -- Nome da empresa
    cnpj VARCHAR(18) NOT NULL UNIQUE,  -- CNPJ da empresa (formato: 'XX.XXX.XXX/XXXX-XX')
    endereco TEXT,                     -- Endereço da empresa
    telefone VARCHAR(15),              -- Telefone da empresa
    email VARCHAR(255)                 -- E-mail de contato
);

CREATE TABLE json_format (
    id CHAR(36) PRIMARY KEY,         -- Identificador único
    nome VARCHAR(255) NOT NULL,      -- Nome do formato JSON (ex: 'oci_format', 'custom_format')
    descricao TEXT,                  -- Descrição sobre o formato JSON
    formato JSON                     -- O próprio formato JSON
);
